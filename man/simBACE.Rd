% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_simBACE.R
\name{simBACE}
\alias{simBACE}
\title{simBACE: Comprehensive simulator of mock data for BACE}
\usage{
simBACE(
  response_type = "gaussian",
  predictor_types = c("gaussian", "gaussian"),
  var_names = NULL,
  beta_matrix = NULL,
  beta_resp = NULL,
  beta_sparsity = 0.7,
  ix_matrix = NULL,
  beta_ix = NULL,
  intercepts = NULL,
  birth = 0.8,
  death = 0.4,
  phylo_signal = NULL,
  n_cases = 200,
  n_species = 75,
  missingness = NULL,
  sigmas = NULL,
  rr = FALSE,
  rr_form = NULL
)
}
\arguments{
\item{response_type}{Type of response variable: "gaussian", "poisson",
"binary", "multinomialK" (unordered categories), or "ordinalK"
(ordered categories coded as integers 1,2,...,K) where K is number of categories}

\item{predictor_types}{Character vector specifying type of each predictor}

\item{var_names}{Character vector of variable names (response + predictors).
If NULL, default names (y, x1, x2, ...) are generated}

\item{beta_matrix}{Square matrix of regression coefficients. Entry i,j-th
indicates effect of predictor j on predictor i. If NULL, a default
sparse matrix is generated}

\item{beta_resp}{Regression coefficients for response on predictors. Can be:
\itemize{
\item A numeric vector of length n_predictors (single values spread automatically
across levels for multinomial predictors)
\item A named list where each element is either a single value OR a vector of
K-1 coefficients for multinomialK predictors (direct specification)
Example: list(x1 = 0.5, x2 = c(-0.3, 0.2, 0.5), x3 = 0.1) for a multinomial4 x2
}}

\item{beta_sparsity}{Proportion of coefficients in beta_matrix to set to zero (default 0.7)}

\item{ix_matrix}{Interaction matrix (lower triangular) defining interactions.
Rows/columns correspond to predictors (x1, x2, ...) with response (y) as last row.
Integer codes indicate which variables interact: variables sharing the same
digit in a row will interact. E.g., for row (12, 1, 2, 0):
\itemize{
\item x1 has codes \{1,2\}, x2 has \{1\}, x3 has \{2\}
\item x1:x2 (share code 1), x1:x3 (share code 2)
Multi-digit numbers encode multiple codes (12 = codes 1 and 2).
}}

\item{beta_ix}{Interaction coefficients. Either NULL (random generation) or
a nested named list: list(y = list("x1:x2" = 0.3, "x1:x3" = -0.2))}

\item{intercepts}{Named list with 'predictors' (vector) and 'response' (scalar)}

\item{birth}{Birth rate for phylogenetic tree simulation (default 0.8)}

\item{death}{Death rate for phylogenetic tree simulation (default 0.4)}

\item{phylo_signal}{Numeric vector of phylogenetic signals for response and
each predictor. Values between 0 and 1 (default 0 = no phylogenetic signal)}

\item{n_cases}{Total number of observations (default 200)}

\item{n_species}{Number of species on the tree (default 75)}

\item{missingness}{Numeric vector indicating proportion of missing values
for response and each predictor (default all 0s = no missing data)}

\item{sigmas}{Named list of variance components:
\itemize{
\item sigma_species: variances for non-phylogenetic species effects
\item sigma_residual: residual variances
Each element is a vector for response + predictors
}}

\item{rr}{Logical, if TRUE allow random slopes (default FALSE)}

\item{rr_form}{Named list specifying random slopes. Each element is named
by random effect and contains character vector of covariate names}
}
\value{
Named list containing:
\itemize{
\item data: data.frame with simulated data
\item tree: phylogenetic tree
\item params: list of simulation parameters used
\item random_effects: list of simulated random effect coefficients
}
}
\description{
simBACE is a function to simulate mock data for BACE.
The function simulates data with defined phylogenetic structure and
with multiple dependencies on additional covariates. The data can be
gaussian, binary, poissonian, multinomial (unordered categories),
or ordinal (ordered categories coded as integers 1,2,3,...).
}
\examples{
# Basic gaussian simulation
sim <- simBACE(
  response_type = "gaussian",
  predictor_types = c("gaussian", "gaussian", "binary"),
  n_cases = 100,
  n_species = 30
)

# With phylogenetic signal and random slopes
sim <- simBACE(
  response_type = "poisson",
  predictor_types = c("gaussian", "binary"),
  phylo_signal = c(0.5, 0.3, 0.1),
  rr = TRUE,
  rr_form = list(species = c("x1"))
)

# With interaction terms
# ix_matrix encoding: rows/cols are x1, x2, x3, y
# Row 4 (y): x1 and x2 share code '1' -> x1:x2 interaction
# Row 4 (y): x1 (code 12) and x3 (code 2) share '2' -> x1:x3 interaction
ix_mat <- matrix(c(
  0, 0, 0, 0,
  0, 0, 0, 0,
  0, 0, 0, 0,
  12, 1, 2, 0
), nrow = 4, byrow = TRUE)
sim <- simBACE(
  response_type = "gaussian",
  predictor_types = c("gaussian", "gaussian", "gaussian"),
  ix_matrix = ix_mat,
  n_cases = 200
)

}
\author{
Szymek Drobniak

Daniel Noble

Shinichi Nakagawa
}
