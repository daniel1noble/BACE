% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bace.R
\name{bace}
\alias{bace}
\title{bace}
\usage{
bace(
  fixformula,
  ran_phylo_form,
  phylo,
  data,
  nitt = 6000,
  thin = 5,
  burnin = 1000,
  runs = 10,
  n_final = 10,
  species = FALSE,
  verbose = TRUE,
  plot = FALSE,
  max_attempts = 3,
  ...
)
}
\arguments{
\item{fixformula}{A character string specifying the fixed effects formula that is of major
interest or a list of formulas that one wishes to estimate. This should be of the form:
y ~ x. Providing a list gives users complex flexibility in the types of models fit for
the different variables. Note that users can also include interaction terms using the
standard R formula syntax (e.g., x1*x2).}

\item{ran_phylo_form}{A character string specifying the random effects and phylogenetic
structure formula used in the model.}

\item{phylo}{A phylogenetic tree of class 'phylo' from the ape package.}

\item{data}{A data frame containing the dataset with missing values to be imputed.}

\item{nitt}{An integer or list specifying the number of iterations to run the MCMC algorithm.
Can be a single value (applied to all models) or a list of values (one per formula).
Default is 6000.}

\item{thin}{An integer or list specifying the thinning rate for the MCMC algorithm. Can be a
single value (applied to all models) or a list of values (one per formula). Default is 5.}

\item{burnin}{An integer or list specifying the number of iterations to discard as burnin.
Can be a single value (applied to all models) or a list of values (one per formula).
Default is 1000.}

\item{runs}{An integer specifying the number of initial imputation iterations for convergence
checking. Default is 10.}

\item{n_final}{An integer specifying the number of final imputation runs to perform after
convergence is achieved. Default is 10. These runs are used for posterior pooling.}

\item{species}{A logical indicating whether to decompose phylogenetic and non-phylogenetic
species effects. Default is FALSE. When TRUE, the random effects structure is modified to
include both a phylogenetic effect and a non-phylogenetic species effect (with identity
matrix in ginverse). This requires sufficient replicated observations per species.}

\item{verbose}{A logical indicating whether to print progress messages. Default is TRUE.}

\item{plot}{A logical indicating whether to plot convergence diagnostics. Default is FALSE.}

\item{max_attempts}{Maximum number of attempts to achieve convergence by increasing runs.
Default is 3.}

\item{...}{Additional arguments to be passed to the underlying modeling functions.}
}
\value{
A list of class 'bace_complete' containing:
\itemize{
\item pooled_models: Pooled posterior distributions accounting for imputation uncertainty
\item final_results: Results from final imputation runs (bace_final object)
\item initial_results: Results from initial convergence runs (bace object)
\item convergence: Convergence assessment results
\item converged: Logical indicating if convergence was achieved
\item n_attempts: Number of attempts needed to achieve convergence
\item call: The function call
}
}
\description{
Wrapper function to perform complete Bayesian imputation using BACE with
convergence checking and posterior pooling across multiple imputations.
}
\examples{
\dontrun{
# Complete BACE analysis with convergence checking and posterior pooling
result <- bace(
  fixformula = "y ~ x1 + x2",
  ran_phylo_form = "~1|Species",
  phylo = phylo_tree,
  data = my_data,
  runs = 10,
  n_final = 10
)

# Access pooled results
summary(result$pooled_models$models$y)

# Check convergence
print(result$convergence)
}
}
